{% extends 'base_admin.html' %}

{% block content %}
<h2>ğŸ‘¥ GestiÃ³n de Usuarios</h2>
<table class="table table-bordered">
  <thead>
    <tr>
      <th>Email</th>
      <th>Â¿Es admin?</th>
      <th>AcciÃ³n</th>
      <th>Publicidad</th>
    </tr>
  </thead>
  <tbody>
    {% for usuario in usuarios %}
    <tr>
      <td>{{ usuario.email }}</td>
      <td>{{ 'SÃ­' if usuario.is_admin else 'No' }}</td>
      <td>
  {% if usuario.id != current_user.id %}
    <a href="{{ url_for('toggle_admin', id=usuario.id) }}"
       class="btn btn-sm {% if usuario.is_admin %}btn-danger{% else %}btn-success{% endif %}">
       {% if usuario.is_admin %}Quitar Admin{% else %}Hacer Admin{% endif %}
    </a>
    <br>
    <a href="{{ url_for('toggle_publicidad', id=usuario.id) }}"
       class="btn btn-sm mt-2 {% if usuario.publicidad_activa %}btn-outline-danger{% else %}btn-outline-success{% endif %}">
       {% if usuario.publicidad_activa %}
         âŒ Quitar publicidad
       {% else %}
         âœ… Activar publicidad
       {% endif %}
    </a>
    {% if usuario.lugar_asociado %}
      <form method="post" action="{{ url_for('desvincular_comercio', id=usuario.id) }}" style="display:inline;">
        <button type="submit" class="btn btn-warning btn-sm mt-2">ğŸ”— Desvincular Comercio</button>
      </form>
    {% endif %}
  {% else %}
    <span class="text-muted">No editable</span>
  {% endif %}
</td>
<td>
  {% if usuario.id != current_user.id %}
    <a href="{{ url_for('toggle_admin', id=usuario.id) }}"
       class="btn btn-sm {% if usuario.is_admin %}btn-danger{% else %}btn-success{% endif %}">
       {% if usuario.is_admin %}Quitar Admin{% else %}Hacer Admin{% endif %}
    </a>
    <br>
    <a href="{{ url_for('toggle_publicidad', id=usuario.id) }}"
       class="btn btn-sm mt-2 {% if usuario.publicidad_activa %}btn-outline-danger{% else %}btn-outline-success{% endif %}">
       {% if usuario.publicidad_activa %}
         âŒ Quitar publicidad
       {% else %}
         âœ… Activar publicidad
       {% endif %}
    </a>
    {% if usuario.lugar_asociado %}
      <form method="post" action="{{ url_for('desvincular_comercio', id=usuario.id) }}" style="display:inline;">
        <button type="submit" class="btn btn-warning btn-sm mt-2">ğŸ”— Desvincular Comercio</button>
      </form>
    {% endif %}
  {% else %}
    <span class="text-muted">No editable</span>
  {% endif %}
</td>
     
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="paginacion">
  {% if usuarios.has_prev %}
    <a href="{{ url_for('admin_usuarios', page=usuarios.prev_num) }}">â† Anterior</a>
  {% endif %}

  <span>PÃ¡gina {{ usuarios.page }} de {{ usuarios.pages }}</span>

  {% if usuarios.has_next %}
    <a href="{{ url_for('admin_usuarios', page=usuarios.next_num) }}">Siguiente â†’</a>
  {% endif %}
</div>


{% endblock %}
